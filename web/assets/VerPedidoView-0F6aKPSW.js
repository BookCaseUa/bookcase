import{_ as O,c as h,a as e,t as s,d as B,j as V,e as f,F as A,x as D,Y as T,B as R,q as U,u as j,r as F,z as L,E as q,h as z,o as v,i as G}from"./index-B0bI5t4i.js";const H={name:"GestionarPedido",setup(){const o=q(),l=T(),m=R(),t=U(),g=j(),P=z(),u=F({orderNumber:"",sellerName:"",shippingAddress:"",comment:"",status:"",totalPrice:0,shippingCost:0,books:[],sellerId:""});return L(async()=>{const p=o.params.id,r=await l.getOrder(p);if((r==null?void 0:r.result)==="SUCCESS"){r.data.buyer_id!==g.id&&P.push("/");const a=r.data,n=[];for(const d of a.offer_ids){const c=await m.getOffer(d);(c==null?void 0:c.result)==="SUCCESS"?n.push(c.data):console.warn(`âŒ Offer ${d} not found`)}await t.fetchEditions(),console.log("Available editions:",t.editions);const _=n.map(d=>{var b,S,$,w,E,C,I,k,y;const c=(b=d.data)==null?void 0:b.edition_id;console.log("Offer edition_id:",c);const i=t.editions.find(N=>N.id===c);return console.log("Edition found:",i),{title:((S=i==null?void 0:i.data)==null?void 0:S.book_title)||(($=d.data)==null?void 0:$.edition_book_name)||"TÃ­tulo desconocido",image:((w=i==null?void 0:i.data)==null?void 0:w.image)||"placeholder.jpg",price:((E=d==null?void 0:d.data)==null?void 0:E.price)||0,language:((C=d==null?void 0:d.data)==null?void 0:C.language)||"",condition:((I=d==null?void 0:d.data)==null?void 0:I.condition)||"",type:((k=i==null?void 0:i.data)==null?void 0:k.type)||"",editorial:((y=i==null?void 0:i.data)==null?void 0:y.editorial)||""}});u.value={orderNumber:a.id,sellerName:a.seller_name||"â€”",shippingAddress:a.shipping_address||"â€”",comment:a.comment||"",status:a.status||"Pendiente",totalPrice:a.total_price||0,shippingCost:a.shipping_cost||0,offers:a.offer_ids,books:_,sellerId:a.seller_id},console.log("ðŸ“¦ Orden cargada:",u.value)}else console.error("âŒ Error al cargar la orden:",r==null?void 0:r.message)}),{order:u}}},M={class:"order-container"},Y={class:"section-title"},J={class:"panel"},K={class:"panel-title"},Q={class:"panel-row"},W={class:"label"},X={class:"value"},Z={class:"panel-row"},x={class:"label"},ee={class:"panel-row"},se={class:"label"},oe={class:"value"},te={class:"panel-row"},de={class:"label"},ae={class:"value italic"},ie={class:"panel-row status-row"},re={class:"label"},ne={class:"panel"},le={class:"panel-title"},ce={class:"book-table"},ue=["src"],pe={class:"price"},_e={class:"panel-row"},he={class:"label"},ve={class:"value price"},me={class:"panel-row"},ge={class:"label"},Pe={class:"value price"},be={class:"help-section"};function Se(o,l,m,t,g,P){var p,r,a;const u=f("Button");return v(),h(A,null,[l[3]||(l[3]=e("div",{class:"header-skip"},null,-1)),e("div",M,[e("h2",Y,"ðŸ“¦ "+s(o.$t("verPedido.titulo")),1),e("div",J,[e("h3",K,"ðŸ§¾ "+s(o.$t("verPedido.detalles")),1),e("div",Q,[e("span",W,"#ï¸âƒ£ "+s(o.$t("verPedido.numero"))+":",1),e("span",X,s(t.order.orderNumber),1)]),e("div",Z,[e("span",x,"ðŸ‘¤ "+s(o.$t("verPedido.vendedor"))+":",1),B(u,{onClick:l[0]||(l[0]=n=>o.$router.push(`/perfil/${t.order.sellerId}`))},{default:V(()=>[G(s(t.order.sellerName),1)]),_:1})]),e("div",ee,[e("span",se,"ðŸ  "+s(o.$t("verPedido.direccion"))+":",1),e("span",oe,s((p=t.order.shippingAddress)==null?void 0:p.direccion)+", "+s((r=t.order.shippingAddress)==null?void 0:r.ciudad)+", "+s((a=t.order.shippingAddress)==null?void 0:a.provincia),1)]),e("div",te,[e("span",de,"ðŸ“ "+s(o.$t("verPedido.comentario"))+":",1),e("span",ae,'"'+s(t.order.comment)+'"',1)]),e("div",ie,[e("span",re,"ðŸ”„ "+s(o.$t("verPedido.estado"))+":",1),e("span",null,s(t.order.status==="PAID"?o.$t("verPedido.pendiente"):t.order.status==="SHIPPED"?o.$t("verPedido.enviado"):t.order.status==="ARRIVED"?o.$t("verPedido.completado"):t.order.status),1)])]),e("div",ne,[e("h3",le,"ðŸ“š "+s(o.$t("verPedido.articulos")),1),e("table",ce,[e("thead",null,[e("tr",null,[e("th",null,s(o.$t("verPedido.portada")),1),e("th",null,s(o.$t("verPedido.tituloTabla")),1),e("th",null,s(o.$t("verPedido.tipo")),1),e("th",null,s(o.$t("verPedido.condicion")),1),l[2]||(l[2]=e("th",null,"Editorial",-1)),e("th",null,s(o.$t("verPedido.precio")),1)])]),e("tbody",null,[(v(!0),h(A,null,D(t.order.books,(n,_)=>(v(),h("tr",{key:_},[e("td",null,[e("img",{src:n.image,alt:"Portada",class:"book-cover"},null,8,ue)]),e("td",null,s(n.title),1),e("td",null,s(n.type),1),e("td",null,s(n.condition),1),e("td",null,s(n.editorial),1),e("td",pe,s(n.price)+" â‚¬",1)]))),128))])]),e("div",_e,[e("span",he,s(o.$t("verPedido.precioEnvio"))+":",1),e("span",ve,s(t.order.shippingCost)+" â‚¬",1)]),e("div",me,[e("span",ge,s(o.$t("verPedido.precioTotal"))+":",1),e("span",Pe,s(t.order.totalPrice)+" â‚¬",1)])]),e("div",be,[e("p",null,s(o.$t("verPedido.preguntaProblema")),1),e("button",{onClick:l[1]||(l[1]=n=>o.$router.push("/contacto")),class:"help-button"},s(o.$t("verPedido.necesitoAyuda")),1)])])],64)}const we=O(H,[["render",Se],["__scopeId","data-v-c2570f33"]]);export{we as default};
