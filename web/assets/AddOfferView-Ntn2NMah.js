import{_ as W,B as j,u as z,Z as G,q as K,l as R,r as c,m as x,z as Z,p as H,j as l,e as s,o as _,d as t,a as J,t as d,g as Q,$ as X,c as O,b as V,i as k}from"./index-B0bI5t4i.js";const Y={class:"text-center mb-6"},ee={key:0},ae={key:1},te={key:2},oe={__name:"AddOfferView",setup(le){const B=j(),U=z(),w=G(),$=K(),{t:n}=R(),m=c(!1),b=c(!1),E=c(!1),f=c(null),g=c([]),u=c({language:null,condition:null,price:null,comment:""}),v={required:e=>!!e||n("nuevaOferta.reglaCampo"),price:e=>e>0||n("nuevaOferta.reglaPrecio")},q=x(()=>[{text:n("nuevaOferta.espanol"),value:"ES"},{text:n("nuevaOferta.ingles"),value:"EN"},{text:n("nuevaOferta.frances"),value:"FR"},{text:n("nuevaOferta.aleman"),value:"DE"},{text:n("nuevaOferta.italiano"),value:"IT"}]),N=x(()=>[{text:n("nuevaOferta.nuevo"),value:"NEW"},{text:n("nuevaOferta.seminuevo"),value:"LIKE NEW"},{text:n("nuevaOferta.bueno"),value:"GOOD"},{text:n("nuevaOferta.aceptable"),value:"ACCEPTABLE"},{text:n("nuevaOferta.malo"),value:"BAD"}]),h=async()=>{if(m.value)try{const e=f.value,o=U.id;await B.createOffer(e,o,u.value.language,u.value.condition,parseFloat(u.value.price),u.value.comment),b.value=!0,f.value=null,u.value={language:null,condition:null,price:null,comment:""},m.value=!1}catch(e){console.error("Error al crear la oferta:",e),alert($t("nuevaOferta.alertaError"))}};return Z(async()=>{await $.getEditions(),await w.getBooks();const e=$.editions,o=w.books;g.value=e.map(i=>{const r=o.find(p=>p.id===i.data.book_id);return{id:i.id,book_title:i.data.book_title,author:r?r.data.author:n("nuevaOferta.autorDesconocido"),genre:r?r.data.genre:n("nuevaOferta.generoDesconocido"),type:i.data.type,image:i.data.image||"default_image_url"}}),console.log("Ediciones cargadas: ",g.value)}),(e,o)=>{const i=s("v-img"),r=s("v-col"),p=s("v-row"),C=s("v-list-item"),D=s("v-autocomplete"),S=s("v-select"),A=s("v-text-field"),I=s("v-textarea"),P=s("v-btn"),L=s("v-form"),T=s("v-card"),y=s("v-snackbar"),F=s("v-container");return _(),H(F,{class:"add-offer-container"},{default:l(()=>[t(T,{elevation:"6",class:"pa-6 offer-card"},{default:l(()=>[J("h2",Y,d(e.$t("nuevaOferta.titulo")),1),t(L,{onSubmit:Q(h,["prevent"]),modelValue:m.value,"onUpdate:modelValue":o[5]||(o[5]=a=>m.value=a)},{default:l(()=>[t(p,null,{default:l(()=>[t(r,{cols:"12",md:"12"},{default:l(()=>[t(D,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=a=>f.value=a),items:g.value,"item-value":"id","item-title":"book_title",label:e.$t("nuevaOferta.seleccionaEdicion"),rules:[v.required],clearable:"",outlined:"","hide-details":"auto","no-data-text":e.$t("nuevaOferta.sinEdiciones")},{item:l(({item:a,props:M})=>[t(C,X(M,{class:"mb-3"}),{default:l(()=>[t(p,{"no-gutters":"",align:"center"},{default:l(()=>[t(r,{cols:"auto"},{default:l(()=>[t(i,{src:a.raw.image||"https://via.placeholder.com/60x90.png",width:"60",height:"90",style:{"border-radius":"4px"},cover:"",class:"mr-2 mt-1"},null,8,["src"])]),_:2},1024),t(r,null,{default:l(()=>[a.raw.author?(_(),O("div",ee,d(e.$t("nuevaOferta.autor"))+" "+d(a.raw.author),1)):V("",!0),a.raw.genre?(_(),O("div",ae,d(e.$t("nuevaOferta.genero"))+" "+d(e.$t(`nuevaOferta.generosLista.${a.raw.genre}`)),1)):V("",!0),a.raw.type?(_(),O("div",te,d(e.$t("nuevaOferta.tipo"))+" "+d(e.$t(`nuevaOferta.tipos.${a.raw.type}`)),1)):V("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","label","rules","no-data-text"])]),_:1}),t(r,{cols:"12",md:"4"},{default:l(()=>[t(S,{modelValue:u.value.language,"onUpdate:modelValue":o[1]||(o[1]=a=>u.value.language=a),label:e.$t("nuevaOferta.idioma"),items:q.value,"item-title":"text","item-value":"value",rules:[v.required]},null,8,["modelValue","label","items","rules"])]),_:1}),t(r,{cols:"12",md:"4"},{default:l(()=>[t(S,{modelValue:u.value.condition,"onUpdate:modelValue":o[2]||(o[2]=a=>u.value.condition=a),label:e.$t("nuevaOferta.condicion"),items:N.value,"item-title":"text","item-value":"value",rules:[v.required]},null,8,["modelValue","label","items","rules"])]),_:1}),t(r,{cols:"12",md:"4"},{default:l(()=>[t(A,{modelValue:u.value.price,"onUpdate:modelValue":o[3]||(o[3]=a=>u.value.price=a),label:e.$t("nuevaOferta.precio"),type:"number",rules:[v.required,v.price],required:"",solo:"",dense:""},null,8,["modelValue","label","rules"])]),_:1}),t(r,{cols:"12"},{default:l(()=>[t(I,{modelValue:u.value.comment,"onUpdate:modelValue":o[4]||(o[4]=a=>u.value.comment=a),label:e.$t("nuevaOferta.comentario"),rows:"3"},null,8,["modelValue","label"])]),_:1}),t(r,{cols:"12",class:"text-center"},{default:l(()=>[t(P,{type:"submit",class:"button-publicar",block:""},{default:l(()=>[k(d(e.$t("nuevaOferta.publicar")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(y,{modelValue:b.value,"onUpdate:modelValue":o[6]||(o[6]=a=>b.value=a),location:"top",color:"green",timeout:"3000"},{default:l(()=>[k(d(e.$t("nuevaOferta.publicada")),1)]),_:1},8,["modelValue"]),t(y,{modelValue:E.value,"onUpdate:modelValue":o[7]||(o[7]=a=>E.value=a),location:"top",color:"red",timeout:"3000"},{default:l(()=>[k(d(e.$t("nuevaOferta.noPublicada")),1)]),_:1},8,["modelValue"])]),_:1})}}},ue=W(oe,[["__scopeId","data-v-8afb3ac1"]]);export{ue as default};
