import{_ as R,u as T,B as U,q as A,l as L,r as d,m as v,E as D,z as I,G as N,c as i,b as c,a as t,p as j,t as s,j as q,D as w,F as y,x as S,e as x,h as M,o as a,i as z}from"./index-B0bI5t4i.js";const G={key:0,class:"profile-container"},Q={class:"profile-header"},W=["src"],H={class:"user-info"},J={class:"username"},K={class:"user-desc"},X={class:"user-desc"},Y={key:0,class:"profile-section"},Z={class:"section-title"},tt={class:"offer-table"},et={class:"offer-table-head"},st={class:"offer-table-head"},ot={class:"offer-table-head"},at={class:"offer-table-head"},it={class:"offer-table-head"},lt={class:"offer-title"},nt=["src"],rt={class:"offer-price"},ct={class:"offer-condition"},dt={class:"offer-language"},ut={key:0,class:"offer-comment"},ft={key:1,class:"profile-section"},_t={class:"wanted-editions-grid"},ht=["onClick"],pt={class:"book-info"},mt=["src"],vt={class:"edition-details"},gt={class:"edition-title"},bt={class:"edition-type"},kt={class:"edition-editorial"},wt={__name:"ProfileView2",setup(yt){const g=T(),E=U(),O=A(),h=D(),{t:St}=L(),C=M(),$=e=>{C.push(`/infoEdicion/${e}`)},n=d(null),b=d([]),p=d({}),m=d([]),u=d(!1),B=()=>{u.value=!u.value},P=v(()=>u.value?f.value:f.value.slice(0,3)),V=v(()=>b.value.filter(e=>e.data.status==="ACTIVE").map(e=>({...e,edition:p.value[e.data.edition_id]||{}}))),F=v(()=>String(g.id)===h.params.id),f=V;I(async()=>{await k(h.params.id)}),N(()=>h.params.id,async e=>{await k(e),window.scrollTo(0,0)});async function k(e){try{n.value=await g.fetchUserById(e);const r=await E.getOffersForUserFiltered(e);r.result==="SUCCESS"&&(b.value=r.data);const _=await O.getEditions();_.result==="SUCCESS"&&(p.value=Object.fromEntries(_.data.map(l=>[l.id,{id:l.id,...l.data}])));const o=n.value.data.wants.map(l=>p.value[l]).filter(Boolean);m.value=o}catch(r){console.error("Error fetching data:",r)}}return(e,r)=>{const _=x("router-link");return n.value?(a(),i("div",G,[t("div",Q,[t("img",{src:n.value.data.profile_photo,alt:"Foto de Perfil",class:"profile-picture"},null,8,W),t("div",H,[t("h2",J,s(n.value.data.name),1),t("h2",K,"@"+s(n.value.data.nickname),1),t("p",X,s(n.value.data.descripcion),1)]),F.value?(a(),j(_,{key:0,to:"/perfil/editar",class:"edit-profile-button"},{default:q(()=>[z(" ✏️ "+s(e.$t("perfil.editar")),1)]),_:1})):c("",!0)]),w(f).length?(a(),i("div",Y,[t("h3",Z,s(e.$t("perfil.misOfertas")),1),t("table",tt,[t("thead",null,[t("tr",null,[t("th",et,s(e.$t("perfil.columnasOfertas.libro")),1),t("th",st,s(e.$t("perfil.columnasOfertas.precio")),1),t("th",ot,s(e.$t("perfil.columnasOfertas.estado")),1),t("th",at,s(e.$t("perfil.columnasOfertas.idioma")),1),t("th",it,s(e.$t("perfil.columnasOfertas.comentario")),1)])]),t("tbody",null,[(a(!0),i(y,null,S(P.value,(o,l)=>(a(),i("tr",{key:o.id,class:"offer-table-row"},[t("td",lt,[t("img",{src:o.edition.image||"https://via.placeholder.com/40x50?text=Libro",alt:"Portada",class:"offer-cover"},null,8,nt),t("span",null,s(o.data.edition_book_name),1)]),t("td",rt,s(o.data.price)+" €",1),t("td",ct,s(o.data.condition),1),t("td",dt,s(o.data.language),1),o.data.comment?(a(),i("td",ut,' "'+s(o.data.comment)+'" ',1)):c("",!0)]))),128))])]),w(f).length>3?(a(),i("button",{key:0,onClick:B,class:"toggle-button"},s(u.value?e.$t("Ocultar"):e.$t("Mostrar Todas")),1)):c("",!0)])):c("",!0),m.value.length?(a(),i("div",ft,[r[0]||(r[0]=t("h3",{class:"section-title"},"📚 Artículos que Quiero",-1)),t("div",_t,[(a(!0),i(y,null,S(m.value,(o,l)=>(a(),i("div",{key:l,class:"wanted-edition-card",onClick:Et=>$(o.id)},[t("div",pt,[t("img",{src:o.image||"https://via.placeholder.com/40x50?text=Libro",alt:"Portada",class:"book-cover"},null,8,mt),t("div",vt,[t("span",gt,s(o.book_title),1),t("span",bt,s(o.type),1),t("span",kt,s(o.editorial),1)])])],8,ht))),128))])])):c("",!0)])):c("",!0)}}},Ct=R(wt,[["__scopeId","data-v-f6df475a"]]);export{Ct as default};
